---
title: "Spatial Referencing"
author: "Adam Stone, PhD"
date: '`r format(Sys.Date(), "%m-%d-%Y")`'
output:
  html_notebook:
    code_folding: hide
    highlight: tango
    theme: paper
    toc: yes
    toc_depth: 2
    toc_float: yes
---

Let's give this a shot!!

First let's see who's in our dataset. This is Test 1 - 3 Bears - Forward

```{r}
library(tidyverse)
library(openxlsx)
library(janitor)

data <- read.xlsx("Test1_Cindy_bears_FW_Examine for Spatial Referencing.xlsx") %>%
  clean_names() %>%
  rename(y = gazepointy_mcspx,
         language = x_language_value,
         name = participantname,
         group = x_group_value) %>%
  filter(language != "NoviceASL_Trained") %>%
  filter(language != "LateASL")

data %>% select(name, group, language) %>% distinct()
```

Now let's graph!! 

Messy, I know, but already we can see some novice ASL has big shifts downward. 

```{r}
data %>%
  ggplot(aes(x = gazepointindex, y = y, color = language)) + geom_path() + scale_y_reverse()

```

Next let's plot the moments where spatial referencing happens. Those are frames

1. 198 to 223
1. 265 to 288
1. 352 to 380

The max gazepointindex is around 2580. At 120 Hz, that's 21.5 seconds which is just right, that's the length. Let's go ahead and convert gazepointindex to seconds.  

So we just have to convert frames to gazepointindex. The video is a total of 536 frames, at 25 FPS that's 21.5 seconds. 535/25 = 21.5, so we divide all those frames by 25. 

1. 7.92s to 8.92s
1. 10.6s to 11.52s
1. 14.08s to 15.2s 

And plot those!

```{r}
data <- data %>%
  rowwise() %>%
  mutate(secs = gazepointindex/120)

data %>%
  ggplot(aes(x = secs, y = y, color = language)) + 
  scale_y_reverse() + 
  geom_path() + 
  annotate("rect", xmin = 7.92, xmax = 8.92, ymin = 0, ymax = 900,
  alpha = .2, fill = "red") +
  annotate("rect", xmin = 10.6, xmax = 11.52, ymin = 0, ymax = 900,
  alpha = .2, fill = "red") +
  annotate("rect", xmin = 14.08, xmax = 15.2, ymin = 0, ymax = 900,
  alpha = .2, fill = "red")
```

Maybe easier if we separate native and novice signers. 

```{r}
data %>%
  ggplot(aes(x = secs, y = y, color = language)) + 
  scale_y_reverse() + 
  geom_path(alpha = 0.5) + 
  annotate("rect", xmin = 7.92, xmax = 8.92, ymin = 0, ymax = 900,
  alpha = .2, fill = "red") +
  annotate("rect", xmin = 10.6, xmax = 11.52, ymin = 0, ymax = 900,
  alpha = .2, fill = "red") +
  annotate("rect", xmin = 14.08, xmax = 15.2, ymin = 0, ymax = 900,
  alpha = .2, fill = "red") +
  facet_grid(language ~ .)
```

Hmm hmm. Novice ASL do have a lot of down shifts but they're not CLEARLY lining up with spatial referencing...or so we think. Let's separate out the Novice signers. 

```{r}
data %>%
  filter(language == "NoviceASL") %>%
  ggplot(aes(x = secs, y = y, color = language)) + 
  scale_y_reverse() + 
  geom_path(alpha = 1) + 
  annotate("rect", xmin = 7.92, xmax = 8.92, ymin = 0, ymax = 900,
  alpha = .2, fill = "red") +
  annotate("rect", xmin = 10.6, xmax = 11.52, ymin = 0, ymax = 900,
  alpha = .2, fill = "red") +
  annotate("rect", xmin = 14.08, xmax = 15.2, ymin = 0, ymax = 900,
  alpha = .2, fill = "red") +
  facet_grid(name ~ .)

data %>%
  filter(language == "EarlyASL") %>%
  ggplot(aes(x = secs, y = y, color = language)) + 
  scale_y_reverse() + 
  geom_path(alpha = 1) + 
  annotate("rect", xmin = 7.92, xmax = 8.92, ymin = 0, ymax = 900,
  alpha = .2, fill = "red") +
  annotate("rect", xmin = 10.6, xmax = 11.52, ymin = 0, ymax = 900,
  alpha = .2, fill = "red") +
  annotate("rect", xmin = 14.08, xmax = 15.2, ymin = 0, ymax = 900,
  alpha = .2, fill = "red") +
  facet_grid(name ~ .)
```

Okay so with Early ASL obviously very steady gaze. NoviceASL has lot of downshifts. Some align with spatial referencing, some do not. We need more of them (let's look at other stories w better data). 
